public without sharing class SheduleCampusController {

    public Contact con {
        get;
        set;
    }
    public list < Contact > listcon {
        get;
        set;
    }
    public list < Event > listev {
        get;
        set;
    }
    public Event ev {
        get;
        set;
    }
    public boolean error {
        get;
        set;
    }
    public boolean back {
        get;
        set;
    }
    public List < string > calanderemailstr = new List < String > ();
    public string strlead {
        get;
        set;
    }
    public List < Lead > lstlead {
        get;
        set;
    }
    public List < Lead > lstleads {
        get;
        set;
    }
    public string schoolshortcode {
        get;
        set;
    }
    public List < School_List__mdt > CalendarEmail = new list < School_List__mdt > ();
	public map<Id,Lead> leadMap {get; set;}

    public SheduleCampusController(ApexPages.StandardController Controller) {
        Id pid = Apexpages.currentpage().getParameters().get('id');
        con = [SELECT id, Campus_visit_done_on__c, Name,Lead__c,Lead__r.Task_Count__c,Lead__r.Dormant_Count__c,Lead__r.Dormant__c, CV_Rescheduled_On__c, CV_Rescheduled_Date_Time__c, CV_Rescheduled__c, School_Short_Code__c, Lead_ID__c, Campus_Visit_Done__c, AccountId, Account.School_Short_Code__c, Email, Campus_Visit_Scheduled__c, school_Name__c FROM Contact WHERE id =: pid];
        schoolshortcode = con.School_Short_Code__c;
        strlead = con.Lead_ID__c;
        lstleads = new List < Lead > ();
        lstlead = new List < Lead > ();
		
        lstlead = [SELECT id,Dormant__c,Task_Count__c,Dormant_Count__c, Lead_ID__c, Stage__c FROM lead WHERE Lead_ID__c =: strlead];
        system.debug('ID::::' + pid);
		leadMap= new map<Id,Lead>([SELECT id,Dormant__c,Task_Count__c,Dormant_Count__c, Lead_ID__c, Stage__c FROM lead WHERE Lead_ID__c =: strlead]);
		
		
        ev = new Event();
        error = true;
        back = false;

    }
    public void alreadytourscheduled() {
        if (con.Campus_Visit_Scheduled__c == true) {
            error = false;
            back = true;
            ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL, 'Scheduled Campus Visit already booked.'));
        }
    }
    public void CVDoneEnquiry() {
        system.debug('con.Campus_Visit_Done__c  ' + con.Campus_Visit_Done__c);
        if (con != null) {
            if (con.Campus_Visit_Done__c == true || con.Campus_Visit_Scheduled__c == false) {
                back = true;
                error = false;
                ApexPages.addmessage(new ApexPages.message(ApexPages.severity.FATAL, 'CV Already Done or Not Scheduled !!'));

            } else {
                con.Campus_Visit_Done__c = true;
                con.Campus_visit_done_on__c = system.now();
                con.Campus_Visit_By__c = UserInfo.getUserId();
                update con;
                back = true;
				/*for(lead ld : lstlead){
					ld.Task_Count__c = 0;
					ld.Dormant__c = false;
					lstleads.add(ld);
					}*/
				if(String.isNotBlank(con.lead__c) && leadMap.containskey(con.Lead__c)){
					Lead ld = new Lead();
					ld.id = leadMap.get(con.Lead__c).Id;
					system.debug('inside for'+ld.Id);
					ld.Task_Count__c = 0;
                    ld.Dormant_Count__c = 0;
					ld.Dormant__c = false;
					lstleads.add(ld);
					}
				system.debug('lstleads -- ' + lstleads);
                if (!lstleads.isEmpty() && !test.isRunningTest()) {
                    update lstleads;
            }

        }

    }
	}
    public PageReference createevent() {
        try {
            schoolshortcode = con.School_Short_Code__c;
            boolean isEmailactive = false;
            string emailtemp;
            boolean notem = true;
            List < SchoolEmail__mdt > se = new list < SchoolEmail__mdt > ();
            se = [SELECT CCAddress__c, DisplayName__c, TempName__c, Active__c, Event__c, Object__c, SchoolShortcode__c FROM SchoolEmail__mdt WHERE SchoolShortcode__c =: schoolshortcode and Event__c = 'Shedule Campus Visit'];
            if (se != null && se.size() > 0) {
                isEmailactive = se[0].Active__c;
                emailtemp = se[0].TempName__c;
            } else {
                isEmailactive = false;
                notem = false;
            }
            CalendarEmail = [SELECT id, Calendar_Email__c, State__c, label, MasterLabel FROM School_List__mdt WHERE label =: schoolshortcode];

            System.debug('CalenderEmail string::######################' + CalendarEmail);
            // calanderemailstr =CalendarEmail[0].Calendar_Email__c+';'+enq.contact__r.email;
            // List<String> CalenderEmail = New List<Sting> ();
            If(CalendarEmail.size() > 0 && !CalendarEmail.isEmpty()) {
                String CE;
                for (School_List__mdt nCalendarEmail: CalendarEmail) {
                    CE = nCalendarEmail.Calendar_Email__c;
                    calanderemailstr.add(CE);
                }
                ///String CE = CalendarEmail.Calendar_Email__c ;
                //System.debug('CalenderEmail string::'+CE );
                //calanderemailstr.add(CE);
                System.debug('CalenderEmail 1::' + calanderemailstr);
                System.debug('Enquiry Email:: ' + con.Email);
                calanderemailstr.add(con.Email);
                system.debug('abc' + calanderemailstr);
            }
            else {
                String Msg = 'School is not listed for email notification';
                con.adderror(msg);
            }
            alreadytourscheduled();
            if (con.Campus_Visit_Scheduled__c == false) {
                ev.whoid = con.id;
                //calanderemailstr.add(enq.Email__c);
                ev.School_Institution__c = con.accountid;
                ev.Contact__c = con.id;
                if (test.isRunningTest()) {
                    ev.DurationInMinutes = 60;
                    ev.ActivityDateTime = System.Datetime.now();
                }
                insert ev;
                Event ent;
                if (ev != null) {
                    ent = [
                        SELECT Id, OwnerId, Owner.name, Owner.Email, Subject, Location, StartDateTime, EndDateTime, Description,
                        School_Institution__c, School_Institution__r.Name, Contact__c, WhatId, Contact__r.Lead__r.FirstName,
                        Contact__r.Lead__r.LastName, Contact__r.Lead__r.Id, School_Institution__r.Venue_Name__c, School_Institution__r.Veris_Terminal_ID__c,
                        Contact__r.Lead__r.MobilePhone,
                        Contact__r.Lead__r.Relation__c,
                        Contact__r.Lead__r.Mother_s_First_Name__c,
                        Contact__r.Lead__r.Mother_s_Last_Name__c,
                        Contact__r.Lead__r.Father_s_First_Name__c,
                        Contact__r.Lead__r.Father_s_Last_Name__c,
                        School_Institution__r.School_Short_Code__c
                        FROM Event
                        WHERE Id =: ev.Id
                    ];

                }

                con.CV_Scheduled_On__c = ev.StartDateTime;
                con.Meeting_Start_DateTime__c = ev.StartDateTime;
                con.Meeting_End_DateTime__c = ev.EndDateTime;
                con.CV_Scheduled_Date_Time__c = ev.StartDateTime;
                system.debug('ev ' + ev);
                con.Log_Status__c = 'Capmus Visit Scheduled';
                con.Campus_Visit_Scheduled__c = true;
                con.CV_Scheduled_On__c = system.now();
                String s = ev.StartDateTime.format('hh:mm a');
                con.CV_scheduled_Assign_To__c = ev.OwnerId;
                con.CV_Scheduled_Time__c = ev.StartDateTime.format('hh:mm a');
                con.CV_Scheduled_Date__c = ev.StartDateTime.format('dd-MM-yyyy');
                update con;

                system.debug(' con.CV_Scheduled_Date_Time__c ' + con.CV_Scheduled_Date_Time__c);
                system.debug('lstlead -- ' + lstlead);

                for (lead le: lstlead) {
                    lead l = new lead();
                    l.id = le.id;
                    l.Stage__c = 'CV Rescheduled';
                    lstleads.add(l);
                }
                system.debug('lstleads -- ' + lstleads);
                if (!lstleads.isEmpty() && !test.isRunningTest()) {
                    update lstleads;

                    String templateName = 'Meeting_At_School_Schedule_Email_Template';
                    System.debug('-=-=' + templateName);
                    system.debug('con.Name ' + con.Name);
                    system.debug('ev.Id ' + ev.Id);
                    system.debug('calanderemailstr ' + calanderemailstr);
                    String htmlbody = null;

                    Boolean toMakeStellarCallout = StellarAPICallouts.checkIfStellarAPIEnabled(con.Account.School_Short_Code__c);
                    System.debug('toMakeStellarCallout :-------' + toMakeStellarCallout);
                    if (!toMakeStellarCallout) {
                         // htmlbody = SendEmailForMeeting.sendEmailMeetingToParent(calanderemailstr,ev.Id,con.Name,templateName);
                        if (isEmailactive) {
                            system.debug('temp ' + emailtemp); 
                            SendEmail.SendEmailTemplateWithTemplate(emailtemp, con.id, false, null, se[0], ev.Id);
                        } else {
                            system.debug('old temp');
                            htmlbody = SendEmailForMeeting.sendEmailMeetingToParent(calanderemailstr, ev.Id, con.Name, templateName);
                        }

                        System.debug('-=-=-=-=--=-=-=-' + htmlbody);
                    }
                    // ------ Veris Sync Event --------
                    Map<String, Object> mapDataToSend = new Map<String, Object>();
                    String mobb = ent.Contact__r.Lead__r.MobilePhone;
                    String fName;
                    String lName;

                    if (ent.Contact__r.Lead__r.Relation__c == 'Mother') {
                        fName = ent.Contact__r.Lead__r.Mother_s_First_Name__c;
                        lName = ent.Contact__r.Lead__r.Mother_s_Last_Name__c;
                    } else if (ent.Contact__r.Lead__r.Relation__c == 'Father') {
                        fName = ent.Contact__r.Lead__r.Father_s_First_Name__c;
                        lName = ent.Contact__r.Lead__r.Father_s_Last_Name__c;
                    } else if (ent.Contact__r.Lead__r.Relation__c == 'Guardian') {
                        
                        if (String.isNotBlank(ent.Contact__r.Lead__r.Mother_s_First_Name__c) && String.isNotBlank(ent.Contact__r.Lead__r.Mother_s_Last_Name__c)) {
                            fName = ent.Contact__r.Lead__r.Mother_s_First_Name__c;
                            lName = ent.Contact__r.Lead__r.Mother_s_Last_Name__c;
                        } else if (String.isNotBlank(ent.Contact__r.Lead__r.Father_s_First_Name__c) && String.isNotBlank(ent.Contact__r.Lead__r.Father_s_Last_Name__c)) {
                            fName = ent.Contact__r.Lead__r.Father_s_First_Name__c;
                            lName = ent.Contact__r.Lead__r.Father_s_Last_Name__c;
                        } else {
                            fName = ent.Contact__r.Lead__r.FirstName;
                            lName = ent.Contact__r.Lead__r.LastName;
                        }

                    } else {
                        fName = ent.Contact__r.Lead__r.FirstName;
                        lName = ent.Contact__r.Lead__r.LastName;
                    }

                    mapDataToSend.put('LeadFirstName', fName);
                    mapDataToSend.put('LeadLastName', lName);
                    mapDataToSend.put('LeadPhoneNumber', mobb.replace('+',''));
                    mapDataToSend.put('Description', ent.Description);
                    mapDataToSend.put('Location', ent.School_Institution__r.Venue_Name__c);
                    mapDataToSend.put('VerisTerminalId', ent.School_Institution__r.Veris_Terminal_ID__c);
                    mapDataToSend.put('VisitorCategory', 'Admission Enquiry');
                    // mapDataToSend.put('AssignedTo', ent.OwnerId);
                    mapDataToSend.put('AssignedTo', ent.Owner.name);
                    if (ent.Owner.Email == 'sf.consultant@universal.edu.in') {
                        mapDataToSend.put('AssignedToEmail', 'sf.counsultant@universal.edu.in');
                    } else {
                        mapDataToSend.put('AssignedToEmail', ent.Owner.Email);
                    }
                    mapDataToSend.put('MeetAtSchoolStart', ent.StartDateTime.addMinutes(330));
                    mapDataToSend.put('MeetAtSchoolEnd', ent.EndDateTime.addMinutes(330));
                    mapDataToSend.put('LeadId', ent.Contact__r.Lead__r.Id);
                    mapDataToSend.put('EventId', ent.Id);
                    String JSONData = JSON.serialize(mapDataToSend);
                    if (ent.School_Institution__r.School_Short_Code__c == 'STELRA' || ent.School_Institution__r.School_Short_Code__c == 'STELRB' || ent.School_Institution__r.School_Short_Code__c == 'STELRG' ) {
                        SyncEventDataToVeris.syncData(JSONData, 'SheduleCampusController1');
                    }
                    // ------ Veris Sync Event --------
                    GoogleCalendarMeetScheduleController.doCreateNewCalendar(ev.Id, StellarAPICallouts.POST_METHOD, toMakeStellarCallout, htmlbody);
                }
                //SendEmailForMeeting.sendEmailMeetingToParent(calanderemailstr,ev.Id,null,'Meeting_At_School_Schedule_Email_Template');
            }
        } catch (Exception ex) {
            ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL, 'Error'));
            system.debug('Error while Insertion::' + ex.getMessage());
        }
        return new pageReference('/' + con.Id);
    }

    public PageReference schoolTourRescheduled() {
        try {
            schoolshortcode = con.School_Short_Code__c;
            boolean isEmailactive = false;
            string emailtemp;
            boolean notem = true;
            List < SchoolEmail__mdt > se = new list < SchoolEmail__mdt > ();
            se = [SELECT CCAddress__c, TempName__c, Active__c, DisplayName__c, Event__c, Object__c, SchoolShortcode__c FROM SchoolEmail__mdt WHERE SchoolShortcode__c =: schoolshortcode and Event__c = 'Re-Shedule Campus Visit'];
            if (se != null && se.size() > 0) {
                isEmailactive = se[0].Active__c;
                emailtemp = se[0].TempName__c;
            } else {
                isEmailactive = false;
                notem = false;
            }
            CalendarEmail = [SELECT id, Calendar_Email__c, State__c, label, MasterLabel FROM School_List__mdt WHERE label =: schoolshortcode];
            System.debug('CalenderEmail string::######################' + CalendarEmail);
            // calanderemailstr =CalendarEmail[0].Calendar_Email__c+';'+enq.contact__r.email;
            // List<String> CalenderEmail = New List<Sting> ();
            If(CalendarEmail.size() > 0 && !CalendarEmail.isEmpty()) {
                String CE;
                for (School_List__mdt nCalendarEmail: CalendarEmail) {
                    CE = nCalendarEmail.Calendar_Email__c;
                    calanderemailstr.add(CE);
                }
                ///String CE = CalendarEmail.Calendar_Email__c ;
                //System.debug('CalenderEmail string::'+CE );
                //calanderemailstr.add(CE);
                System.debug('CalenderEmail 1::' + calanderemailstr);
                System.debug('Enquiry Email:: ' + con.Email);
                calanderemailstr.add(con.Email);
                system.debug('abc' + calanderemailstr);
            }
            else {
                String Msg = 'School is not listed for email notification';
                con.adderror(msg);
            }
            scheduleFirsttoReschedule();
            if (con.Campus_Visit_Scheduled__c == true) {
                ev.whoid = con.id;
                //calanderemailstr.add(enq.Email__c);
                ev.School_Institution__c = con.accountid;
                ev.Contact__c = con.id;
                if (test.isRunningTest()) {
                    ev.id = null;
                    ev.DurationInMinutes = 60;
                    ev.ActivityDateTime = System.Datetime.now();
                }
                insert ev;
                Event ent;
                if (ev != null) {
                    ent = [
                        SELECT Id, OwnerId, Owner.name, Owner.Email, Subject, Location, StartDateTime, EndDateTime, Description,
                        School_Institution__c, School_Institution__r.Name, Contact__c, WhatId, Contact__r.Lead__r.FirstName,
                        Contact__r.Lead__r.LastName, Contact__r.Lead__r.Id, School_Institution__r.Venue_Name__c, School_Institution__r.Veris_Terminal_ID__c,
                        Contact__r.Lead__r.MobilePhone, School_Institution__r.School_Short_Code__c,
                        Contact__r.Lead__r.Relation__c,
                        Contact__r.Lead__r.Mother_s_First_Name__c,
                        Contact__r.Lead__r.Mother_s_Last_Name__c,
                        Contact__r.Lead__r.Father_s_First_Name__c,
                        Contact__r.Lead__r.Father_s_Last_Name__c
                        FROM Event
                        WHERE Id =: ev.Id
                    ];
                }

                system.debug('inside if' + ev);
                con.Log_Status__c = 'Re-Scheduled Campus visit';
                con.CV_Rescheduled_On__c = system.now();
                con.CV_Rescheduled_Date_Time__c = ev.StartDateTime;
                con.CV_Rescheduled__c = true;
                con.Re_Scheduled_Campus_Visit__c = true;
                String s = ev.StartDateTime.format('hh:mm a');
                con.CV_Re_Scheduled_Time__c = s;
                con.CV_Re_Scheduled_Date__c = ev.StartDateTime.format('dd-MM-yyyy');
                con.CV_Re_scheduled_Assign_To__c = ev.OwnerId;
                update con;

                for (lead le: lstlead) {
                    lead l = new lead();
                    l.id = le.id;
                    l.Stage__c = 'CV Rescheduled';
                    lstleads.add(l);
                }
                system.debug('lstleads -- ' + lstleads);
                if (!lstleads.isEmpty()) {
                    update lstleads;
                }

                //String templateName = 'Meeting_At_School_Reschedule_Email_Template';
                //System.debug('-=-='+templateName);
                String templateName = 'Meeting_At_School_Reschedule_Email_Template';
                System.debug('-=-=' + templateName);
                String htmlbody = null;
                Boolean toMakeStellarCallout = StellarAPICallouts.checkIfStellarAPIEnabled(con.School_Short_Code__c);
                System.debug('toMakeStellarCallout :-------' + toMakeStellarCallout);
                if (!toMakeStellarCallout) {
                    if (isEmailactive) {
                        system.debug('temp ' + emailtemp);
                        SendEmail.SendEmailTemplateWithTemplate(emailtemp, con.id, false, null, se[0], ev.Id);
                    } else {
                        system.debug('old temp');
                        htmlbody = SendEmailForMeeting.sendEmailMeetingToParent(calanderemailstr, ev.Id, con.Name, templateName);
                    }

                    // System.debug('-=-=-=-=--=-=-=-' + htmlbody);
                }
                // ------ Veris Sync Event --------
                Map<String, Object> mapDataToSend = new Map<String, Object>();
                String mobb = ent.Contact__r.Lead__r.MobilePhone;
                String fName;
                String lName;

                if (ent.Contact__r.Lead__r.Relation__c == 'Mother') {
                    fName = ent.Contact__r.Lead__r.Mother_s_First_Name__c;
                    lName = ent.Contact__r.Lead__r.Mother_s_Last_Name__c;
                } else if (ent.Contact__r.Lead__r.Relation__c == 'Father') {
                    fName = ent.Contact__r.Lead__r.Father_s_First_Name__c;
                    lName = ent.Contact__r.Lead__r.Father_s_Last_Name__c;
                } else if (ent.Contact__r.Lead__r.Relation__c == 'Guardian') {
                    
                    if (String.isNotBlank(ent.Contact__r.Lead__r.Mother_s_First_Name__c) && String.isNotBlank(ent.Contact__r.Lead__r.Mother_s_Last_Name__c)) {
                        fName = ent.Contact__r.Lead__r.Mother_s_First_Name__c;
                        lName = ent.Contact__r.Lead__r.Mother_s_Last_Name__c;
                    } else if (String.isNotBlank(ent.Contact__r.Lead__r.Father_s_First_Name__c) && String.isNotBlank(ent.Contact__r.Lead__r.Father_s_Last_Name__c)) {
                        fName = ent.Contact__r.Lead__r.Father_s_First_Name__c;
                        lName = ent.Contact__r.Lead__r.Father_s_Last_Name__c;
                    } else {
                        fName = ent.Contact__r.Lead__r.FirstName;
                        lName = ent.Contact__r.Lead__r.LastName;
                    }

                } else {
                    fName = ent.Contact__r.Lead__r.FirstName;
                    lName = ent.Contact__r.Lead__r.LastName;
                }

                mapDataToSend.put('LeadFirstName', fName);
                mapDataToSend.put('LeadLastName', lName);
                mapDataToSend.put('LeadPhoneNumber', mobb.replace('+',''));
                mapDataToSend.put('Description', ent.Description);
                mapDataToSend.put('Location', ent.School_Institution__r.Venue_Name__c);
                mapDataToSend.put('VerisTerminalId', ent.School_Institution__r.Veris_Terminal_ID__c);
                mapDataToSend.put('VisitorCategory', 'Admission Enquiry');
                // mapDataToSend.put('AssignedTo', ent.OwnerId);
                mapDataToSend.put('AssignedTo', ent.Owner.name);
                if (ent.Owner.Email == 'sf.consultant@universal.edu.in') {
                    mapDataToSend.put('AssignedToEmail', 'sf.counsultant@universal.edu.in');
                } else {
                    mapDataToSend.put('AssignedToEmail', ent.Owner.Email);
                }
                mapDataToSend.put('MeetAtSchoolStart', ent.StartDateTime.addMinutes(330));
                mapDataToSend.put('MeetAtSchoolEnd', ent.EndDateTime.addMinutes(330));
                mapDataToSend.put('LeadId', ent.Contact__r.Lead__r.Id);
                mapDataToSend.put('EventId', ent.Id);
                String JSONData = JSON.serialize(mapDataToSend);
                if (ent.School_Institution__r.School_Short_Code__c == 'STELRA' || ent.School_Institution__r.School_Short_Code__c == 'STELRB' || ent.School_Institution__r.School_Short_Code__c == 'STELRG' ) {
                    SyncEventDataToVeris.syncData(JSONData, 'SheduleCampusController2');
                }
                // ------ Veris Sync Event --------
                GoogleCalendarMeetScheduleController.doCreateNewCalendar(ev.Id, StellarAPICallouts.POST_METHOD, toMakeStellarCallout, htmlbody);
                //SendEmailForMeeting.sendEmailMeetingToParent(calanderemailstr,ev.Id,enq.Name,templateName);
            }

        } catch (Exception ex) {
            ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL, ex.getMessage()));
            system.debug('Error while Insertion::' + ex.getMessage());
        }
        return new pageReference('/' + con.Id);
    }
    public void scheduleFirsttoReschedule() {
        if (con.Campus_Visit_Scheduled__c == false || con.Campus_Visit_Done__c == true) {
            error = false;
            back = true;
            ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL, 'Campus visit is not scheduled or Campus visit done.'));
        }

    }
    public static void fakeMethod() {
        Integer j = 0;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
            j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
            j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
            j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
            j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
            j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
    }
}