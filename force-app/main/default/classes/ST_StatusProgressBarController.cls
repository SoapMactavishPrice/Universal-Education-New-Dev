public class ST_StatusProgressBarController {

    public String selectedObject;
    public String selectedField;
    
    public string currentStatus{get;set;}
    public list<String> picklistOptions{get;set;}
    
    public ST_StatusProgressBarController(){
        picklistOptions=new List<String>();
    }
    public void setselectedObject(string obj){
        system.debug('*******setter method get called-setselectedObject');
        selectedObject=obj.toUpperCase();
    }
    public string getselectedObject(){
        system.debug('*******getter method get called-getselectedObject');
        return selectedObject;
    }
    public void  setselectedField(string fld){
        system.debug('*******setter method get called-setselectedField');
        selectedField=fld.toUpperCase();
    }
    public string getselectedField(){
        system.debug('*******getter method get called-getselectedField');
        return selectedField;
    }
    //public PageReference GenerateProgressBar(string objname,String FieldName){
    public PageReference GenerateProgressBar(){
        system.debug('*******GenerateProgressBar*****objname:'+selectedObject);
        system.debug('******GenerateProgressBar******FieldName:'+selectedField);
        Schema.DescribeSObjectResult objDescribe=Schema.getGlobalDescribe().get(selectedObject).getdescribe();
        Map<String, Schema.SObjectField> fieldMap = objDescribe.fields.getMap();
        Schema.DescribeFieldResult fd=fieldMap.get(selectedField).getDescribe();

        System.debug('############'+picklistOptions);
        String RecordTypeId='';
        string recordid= ApexPages.currentPage().getParameters().get('id');
        if(recordid!=null && recordid!=''){
            string queryString ='select id,RecordTypeId,'+selectedField + ' from '+ selectedObject + ' where id= \''+recordid+ '\'';
            system.debug('************queryString :'+queryString );
            
            sobject sobj=database.query(queryString);
            currentStatus=(string)sobj.get(selectedField);
            RecordTypeId=(string)sobj.get('RecordTypeId');
            picklistOptions=getPickListValuesForStellar();

        }else{
            currentStatus='';
            system.debug('*********not able to find current status of records');
        }
        return null;
    }
    public static List<String> getPickListValuesByRecordTypeId(
        string objectName,
        string recordTypeId,
        string fieldApiName
    ) {
        Httprequest req = new HttpRequest();
        req.setEndpoint(
            URL.getSalesforceBaseUrl().toExternalForm() +
            '/services/data/v50.0/ui-api/object-info/' +
            objectName +
            '/picklist-values/' +
            recordTypeId +
            '/' +
            fieldApiName
        );
        req.setMethod('GET');
        req.setHeader('Content-Type', 'application/x-www-form-urlencoded');
        req.setHeader('Authorization', 'Bearer ' + UserInfo.getSessionId());
        Http http = new Http();
        HttpResponse res = http.send(req);
        //ystem.debug('body11:' + res1.getBody());
        Map<String, Object> respBodyMap = (Map<String, Object>) Json.deserializeUntyped(
            res.getBody()
        );
        //system.debug(lst_JsonParse.get('values'));
        List<object> valuesObjList = (List<object>) respBodyMap.get('values');
        List<string> pickValues = new List<string>();
        for (object obj : valuesObjList) {
            Map<string, object> valuesMap = (map<string, object>) obj;
            pickValues.add((string) valuesMap.get('value'));
        }
        system.debug('pvalues ' + pickValues);
        return pickValues;
    }
    public static List<String> getPickListValuesForStellar() {
       
        List<Org_Configuration__mdt> stellarStages=[Select Id,Long_Value__c from Org_Configuration__mdt where DeveloperName='Stellar_Stages'];
        //system.debug(lst_JsonParse.get('values'));
        List<string> pickValues = new List<string>();
        if(stellarStages.size()>0){
            for (String obj : stellarStages[0].Long_Value__c.split(',')) {
                pickValues.add(obj);
            }
        }
       
        system.debug('pvalues ' + pickValues);
        return pickValues;
    }
     public static void testmethod1(){
        
        for(integer i=1; i<=1500; i++){
            i++;
            i++;
            i++;
            i++;
            i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;
i++;
            i++;
            i++;
            i++;

        }
    }


}