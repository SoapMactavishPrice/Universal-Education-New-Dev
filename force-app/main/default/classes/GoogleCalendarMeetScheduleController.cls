/*
* Class that is used to Create event in Google Calender for Meet Online Button
* @author  Hitesh Shantaram Nimje    select id, Address, DisplayName from OrgWideEmailAddress
* @created 16/09/2020
*/
public class GoogleCalendarMeetScheduleController {
    public Enquiry__c enq{get;set;}
    public list<Enquiry__c> listenq{get;set;}
    public list<Event> listev{get;set;}
    public Event ev{get;set;}
    public boolean error{get;set;}
    public boolean back{get;set;}
    public static Integer statusCode = 0;
    public static String pid = '';
    public string[] senttoadd{get;set;}
    public List<School_List__mdt> CalendarEmail= new list<School_List__mdt>();
    public string schoolshortcode{get;set;}
    public List<string> calanderemailstr  = new List<String>();
    public List<School_List__mdt> CalendarEmailMdt = new list<School_List__mdt>();
    public String[] Emails {get;set;}
    public string strlead{get;set;}
    public List<Lead> lstlead{get;set;}
    public List<Lead> lstleads {get;set;}
    
    public GoogleCalendarMeetScheduleController(ApexPages.StandardController Controller){
        pid = Apexpages.currentpage().getParameters().get('id');
        enq = [select id,Name,Org_code__c,School_Institution__c,Log_Status__c,Meet_Online_Scheduled__c,Meet_Online_Rescheduled__c,
               Contact__c,Contact__r.Email,Contact__r.Account.Name,Email__c, School_Institution__r.School_Short_Code__c,Lead_ID__c,
               Interaction_Done__c,(SELECT Subject, WhatId, IsTask, ActivityDate, Status, Priority, OwnerId FROM OpenActivities WHERE WhatId = :pid ) from Enquiry__c where id=:pid];
        schoolshortcode = enq.Org_code__c;
        CalendarEmail=[select id,Calendar_Email__c,State__c,label,MasterLabel from School_List__mdt where label=:schoolshortcode];
        // orgwideaddress=[select id, Address, DisplayName from OrgWideEmailAddress];
         strlead = enq.Lead_ID__c;
        lstleads = new List<Lead>();
        lstlead = new List<Lead>();
        lstlead = [select id,Lead_ID__c,Stage__c from lead where Lead_ID__c=:strlead];
        system.debug('PID::::'+pid);
        ev=new Event();
        error=true;
        back = false;
    }
    
    
    public PageReference createevent()
    {
        //try{
            schoolshortcode = enq.Org_code__c;
            CalendarEmail=[select id,Calendar_Email__c,State__c,label,MasterLabel from School_List__mdt where label=:schoolshortcode];
            // calanderemailstr =CalendarEmail[0].Calendar_Email__c+';'+enq.contact__r.email;
            // List<String> CalenderEmail = New List<Sting> ();
            If (CalendarEmail.size() > 0 && !CalendarEmail.isEmpty() ){
                String CE = CalendarEmail[0].Calendar_Email__c ;
                System.debug('CalenderEmail string::'+CE );
                calanderemailstr.add(CE);
                System.debug('CalenderEmail 1::'+calanderemailstr);
                System.debug('Enquiry Email:: ' +enq.Email__c );
                calanderemailstr.add(enq.Email__c);
                system.debug('abc' +calanderemailstr);
            }
            else {
                String Msg = 'School is not listed for email notification';
                enq.adderror(msg);
            }
            alreadytourscheduled();
            if(enq.Meet_Online_Scheduled__c==false){
                //  List<Id> evId = new List<Id>();
                ev.WhatId = enq.id;
                ev.Enquiry_Email__c = enq.Email__c;
                ev.School_Institution__c= enq.School_Institution__c;
                //ev.School_Institution__c = enq.Contact__r.Account.Name;
                //ev.DurationInMinutes = Integer.valueOf(system.label.DurationInMinutes);
                ev.Contact__c = enq.Contact__c ;
                insert ev;
                // evId.add(ev.Id);
                enq.Log_Status__c = 'Meet Online Scheduled';
                enq.Meet_Online_Scheduled__c = true;
                enq.Meet_Online_Scheduled_On__c = System.now();
                update enq;
                
                  system.debug('lstlead -- ' + lstlead);
                for(lead le : lstlead){
                    lead l = new lead();
                    l.id = le.id; l.Stage__c = 'Meet Online Scheduled';
                    lstleads.add(l);
                }
                system.debug('lstleads -- ' + lstleads);
                if(!lstleads.isEmpty()){update lstleads;
                }
                String templateName = 'Meeting_Online_Schedule_Email_Template';
                System.debug('-=-='+templateName);
                String htmlbody = null;
                Boolean toMakeStellarCallout = StellarAPICallouts.checkIfStellarAPIEnabled(enq.School_Institution__r.School_Short_Code__c);
                System.debug('toMakeStellarCallout :-------'+  toMakeStellarCallout);
                if (!toMakeStellarCallout) {
                    htmlbody = SendEmailForMeeting.sendEmailMeetingToParent(calanderemailstr,ev.Id,enq.Name,templateName);
                    System.debug('-=-=-=-=--=-=-=-'+htmlbody);
                }
                doCreateNewCalendar(ev.Id, StellarAPICallouts.POST_METHOD, toMakeStellarCallout, htmlbody);
            }
        //}
        //catch(Exception ex){
            //ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL,'Error'));
            //system.debug('Error while Insertion::'+ex.getLineNumber() +' ' +ex.getMessage());
        //}
        return  new pageReference('/'+enq.Id);
    }
    
    public void alreadytourscheduled(){
        if(enq.Meet_Online_Scheduled__c==true && enq.Log_Status__c == 'Meet Online Scheduled')
        {
            error=false;
            back = true;
            ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL,'Meet online already scheduled.'));
        }
        if(enq.Interaction_Done__c==true)
        {
            error=false;
            back=true;
            ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL,'Interaction Done. You can not schedule Online Meet.'));
            
        }
    }
    
    public PageReference schoolTourRescheduled()
    {
        //try{
            scheduleFirsttoReschedule();
            if(enq.Meet_Online_Scheduled__c == true && enq.Interaction_Done__c == false){
                // List<Event> e = [SELECT Id, StartDateTime, EndDateTime,Contact__r.Name,Contact__r.Email, Description,Subject FROM Event WHERE WhatId = :enq.id];
                ev.WhatId = enq.id;
                ev.School_Institution__c= enq.School_Institution__c;
                ev.Contact__c = enq.Contact__c ;
                ev.Enquiry_Email__c = enq.Email__c;
                // ev.School_Institution__c = enq.Contact__r.Account.Name;
                insert ev;
                system.debug('inside if'+ev);
                enq.Log_Status__c = 'Meet Online Re-Scheduled';
                enq.Meet_Online_Rescheduled__c=true;
                update enq;
                
                system.debug('lstlead -- ' + lstlead);
                for(lead le : lstlead){
                    lead l = new lead();
                    l.id = le.id; l.Stage__c = 'Meet Online Re-Scheduled';
                    lstleads.add(l);
                }
                system.debug('lstleads -- ' + lstleads);
                if(!lstleads.isEmpty()){update lstleads;
                }
                schoolshortcode = enq.Org_code__c;
                CalendarEmail=[select id,Calendar_Email__c,State__c,label,MasterLabel from School_List__mdt where label=:schoolshortcode];
                // calanderemailstr =CalendarEmail[0].Calendar_Email__c+';'+enq.contact__r.email;
                // List<String> CalenderEmail = New List<Sting> ();
                If (CalendarEmail.size() > 0 && !CalendarEmail.isEmpty() ){
                    String CE = CalendarEmail[0].Calendar_Email__c ;
                    System.debug('CalenderEmail string::'+CE );
                    
                    calanderemailstr.add(CE);
                    System.debug('CalenderEmail 1::'+calanderemailstr);
                    
                    System.debug('Enquiry Email:: ' +enq.Email__c );
                    calanderemailstr.add(enq.Email__c);
                    system.debug('abc' +calanderemailstr);
                }
                else {
                    String Msg = 'School is not listed for email notification';
                    enq.adderror(msg);
                }
                String HTMLbody = null;
                Boolean toMakeStellarCallout = StellarAPICallouts.checkIfStellarAPIEnabled(enq.School_Institution__r.School_Short_Code__c);
                if (!toMakeStellarCallout) {
                    HTMLbody = SendEmailForMeeting.sendEmailMeetingToParent(calanderemailstr,ev.Id,enq.Name,'Meeting_Online_Reschedule_Email_Template');
                }
                doCreateNewCalendar(ev.Id, StellarAPICallouts.PUT_METHOD, toMakeStellarCallout, HTMLbody);
            }
        //}
        //catch(Exception ex){
            //ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL,'Error'));
           // system.debug('Error while Insertion::'+ex.getMessage());
       // }
        return  new pageReference('/'+enq.Id);
    }
    
    public void scheduleFirsttoReschedule()
    {
        if(enq.Meet_Online_Scheduled__c == false && enq.Log_Status__c == 'Meet Online Scheduled')
        {
            error=false;
            back = true;
            ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL,'To Re-Scheduled, you have to Schedule a Meet online first.'));
        }
        if(enq.Interaction_Done__c==true)
        {
            error=false;
            back=true;
            ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL,'Interaction Done. You can not scheduled Online Meet.'));
            
        }
        /* if(enq.OpenActivities.Size() != 0)
{
error=false;
back=true;
ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL,'Meeting Date Not Expire till Now'));
System.debug('=-=-=-=-'+enq.OpenActivities);
} */
    }
    public PageReference intractionDone()
    {
        PageReference pg;
        //try{
            
            if(enq.Meet_Online_Scheduled__c==False){
                ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL,'First Schedule the Online Meet.'));
            }
            
            if(enq.Interaction_Done__c == true && enq.Log_Status__c == 'Interaction Done'){
                ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL,'Intraction is already Done!'));
            }
            
            if((enq.Meet_Online_Scheduled__c==true && enq.Meet_Online_Rescheduled__c == False && enq.Interaction_Done__c == false)||(enq.Meet_Online_Scheduled__c==true && enq.Meet_Online_Rescheduled__c==true && enq.Interaction_Done__c==false))
            {
                enq.Interaction_Done__c=true;
                enq.Log_Status__c = 'Interaction Done';
                update enq;
                pg= new pageReference('/'+enq.Id);
            }
            
            
       // }
       // catch(Exception ex){
           // ApexPages.addMessage(new ApexPages.message(ApexPages.severity.FATAL,'Error'));
           // system.debug('Error ::'+ex.getMessage());
       // }
        return  pg;
    }
    
    public PageReference cancel()
    {
        return  new pageReference('/'+enq.Id);
    }
    public static void doCreateNewCalendar(String eventId, String htmlBody){
        doCreateNewCalendar(eventId, '', false, htmlBody);
        
    }
    @future(Callout = true)
    public static void doCreateNewCalendar(String eventId , String method, Boolean toMakeStellarCallout, String htmlBody  ){
        HttpResponse HttpRes = GoogleCalendarMeetScheduleController.doCreateNewCalendarEvent(eventId,htmlBody);
         System.debug('HttpRes evts: @'+           HttpRes);
        String Ssortcode = '';
        if(HttpRes != null && String.isNotBlank(HttpRes.getBody()) && HttpRes.getStatusCode() == 200 && (toMakeStellarCallout || System.Test.isRunningTest())){
            String meetLink = '';
            String theBody = HttpRes.getBody();
            if(String.isNotBlank(theBody)){
                Map<String, Object> responseBodyMap =  (Map<String, Object>) JSON.deserializeUntyped(theBody);
                Object meetLinkObj = responseBodyMap.get('hangoutLink');
                meetLink = meetLinkObj != null ? String.valueOf(meetLinkObj) : '';
            }
            List<Event> evts = [SELECT Id, What.Name, StartDateTime,Enquiry_Email__c, EndDateTime,Contact__r.Name,Contact__r.Email,School_Institution__c, School_Institution__r.Name, School_Institution__r.For_Mapping_Email__c, School_Institution__r.School_Short_Code__c,  Description,Subject FROM Event WHERE Id = :eventId];
            Event evt;
            System.debug('gmeet evts: '+evts);
            Enquiry__c enq;
            Boolean isAdmissionForm = false;
            String email = '', firstName = '', lastName = '', name = '', appEnqNo = '';
            if(evts != null && !evts.isEmpty()){
                evt = evts[0];
                Id theWhatId = evt.WhatId;
                if(theWhatId != null && theWhatId.getSObjectType().getDescribe().getName().containsIgnoreCase('Admission_Form__c')){
                    isAdmissionForm = true;
                    Admission_Form__c adf = [Select id,Name, Email_Address__c, First_Name__c, Last_Name__c, Student_Name__c, Application_No__c,Application_Form__c,Document_Received__c,Academic__c,Status__c,Called_for_Observation__c,Observation_Re_scheduled__c,School_Short_Code__c from Admission_Form__c where id=: theWhatId];
                    email = adf.Email_Address__c;
                    firstName = adf.First_Name__c;
                    lastName = adf.Last_Name__c;
                    name = adf.Student_Name__c;
                    appEnqNo = adf.Application_No__c;
                }else{
                    enq = [SELECT Id, Name, Stages__c, Log_Status__c, Email__c, FirstName__c, Last_Name__c, Student_Full_Name__c FROM Enquiry__c WHERE Id = :theWhatId];
                    email = enq.Email__c;
                    firstName = enq.FirstName__c;
                    lastName = enq.Last_Name__c;
                    name = enq.Student_Full_Name__c;
                    appEnqNo = enq.Name;
                }
            }else{
                System.debug('Some Error: evt '+evt);
                System.debug('Some Error: enq '+enq);
            }
            String appEnqNoKey = isAdmissionForm ? 'applicationNo' : 'enquiryNo';
            List<String> keyList = new List<String>{
                // 'startDateTime', 'endDateTime', 'subject', 'description', 'Email', 'studentEmail', 'meetLink'
                'email', 'firstName', 'lastName', 'name', appEnqNoKey, 'meetLink'
                    };
                        List<Object> valueList = new List<Object>{
                            // evt.StartDateTime, evt.EndDateTime, evt.Subject, evt.Description, evt.Enquiry_Email__c, evt.Contact__r.Email, meetLink
                            email, firstName, lastName, name, appEnqNo, meetLink
                                };
                                    
                                    Map<String, Object> requestBody = StellarAPICallouts.createBody(
                                        keyList, valueList
                                    
                                    );
            StellarAPICallouts.makeCallout('https://admission.stellarworldschool.com/meet', method, requestBody);
        }
        //  List<School_List__mdt> CalendarEmailMdt = new list<School_List__mdt>)();
    }
    
    public static HttpResponse doCreateNewCalendarEvent(String eventId,String htmlBody){
        System.debug('-=-=-=-=+eventId ++-=--=-=-='+ eventId);
        List<Event> e = new list <event>();
        set<Id> nwhatId= new set<Id>();
        // Added billing address fields to query
        e =   [SELECT Id,whatId,WhoId, StartDateTime,Enquiry_Email__c, EndDateTime,Contact__r.Name,Contact__r.Email,School_Institution__c, 
               School_Institution__r.Name, School_Institution__r.For_Mapping_Email__c, School_Institution__r.School_Short_Code__c,
               School_Institution__r.BillingStreet, School_Institution__r.BillingCity, School_Institution__r.BillingState, 
               School_Institution__r.BillingPostalCode, School_Institution__r.BillingCountry,
               Description,Subject FROM Event WHERE Id = :eventId];
        System.debug('-=-=-=-=+ Event record ++-=--=-=-='+ e);
        if(!e.isEmpty()){
            for(Event oe:e){
                nwhatId.add(oe.WhatId);
            }
        }
        String objectStartWithAdmissionFormObj = system.Label.StartsWithAdmissionFormObj;
        String objectStartWithEnquiresObj = system.Label.StartsWithEnquiresObj;
        System.debug(' objectStartWithAdmissionFormObj============================================'+ objectStartWithAdmissionFormObj);
        System.debug(' objectStartWithEnquiresObj ============================================'+ objectStartWithEnquiresObj);
        System.debug(' nwhatId record ============================================'+ nwhatId);
        Enquiry__c  ooooEnquirY =new Enquiry__c();
        Admission_Form__c  ooooAdmission_Form = new Admission_Form__c();
        system.debug('ooooEnquirY******************************************' + string.valueof(nwhatId).startsWith(objectStartWithEnquiresObj));
        system.debug('ooooEnquirY******************************************' + string.valueof(nwhatId).startsWith(objectStartWithAdmissionFormObj));
        if(string.valueof(nwhatId).contains(objectStartWithEnquiresObj)){
        	ooooEnquirY = [SELECT Id,School_Tour_Scheduled__c,Org_code__c,School_Tour_Re_Scheduled__c,Email__c FROM Enquiry__c WHERE Id = :nwhatId];

        }
        if(string.valueof(nwhatId).contains(objectStartWithAdmissionFormObj)){
        	ooooAdmission_Form = [SELECT Id,Non_Stellar_Interaction_Scheduled__c,Enquiry_No__c,School_Short_Code__c,Non_Stellar_Interaction_Reschedule__c,Email_Address__c FROM Admission_Form__c WHERE Id = :nwhatId];
        }
        system.debug('ooooEnquirY******************************************' + ooooEnquirY);
        system.debug('ooooAdmission_Form******************************************' + ooooAdmission_Form);
        String orgid = '';
        String Ssortcode = e[0].School_Institution__r.School_Short_Code__c ;
        
        // Format the billing address
        String locationAddress = '';
        if(e[0].School_Institution__c != null){
            List<String> addressParts = new List<String>();
            if (String.isNotBlank(e[0].School_Institution__r.Name)) {
                addressParts.add(e[0].School_Institution__r.Name);
            }
            if(String.isNotBlank(e[0].School_Institution__r.BillingStreet)){
                addressParts.add(e[0].School_Institution__r.BillingStreet);
            }
            if(String.isNotBlank(e[0].School_Institution__r.BillingCity)){
                addressParts.add(e[0].School_Institution__r.BillingCity);
            }
            if(String.isNotBlank(e[0].School_Institution__r.BillingState)){
                addressParts.add(e[0].School_Institution__r.BillingState);
            }
            if(String.isNotBlank(e[0].School_Institution__r.BillingPostalCode)){
                addressParts.add(e[0].School_Institution__r.BillingPostalCode);
            }
            if(String.isNotBlank(e[0].School_Institution__r.BillingCountry)){
                addressParts.add(e[0].School_Institution__r.BillingCountry);
            }
            locationAddress = String.join(addressParts, ', ');
        }
        System.debug('Formatted Location Address: ' + locationAddress);
        
        If (e.size() > 0 &&  Ssortcode!= Null)
        {
            
        }
        //  {CalendarEmail[0].Calendar_Email__c, e[0].Contact__r.Email }  ;
        for(OrgWideEmailAddress owa : [SELECT Id, Address,DisplayName FROM OrgWideEmailAddress WHERE Address LIKE 'notification%']) {
            if(owa.DisplayName.contains(e[0].School_Institution__r.For_Mapping_Email__c)){
                System.debug('-=-=-=-=+++-=--=-=-='+owa.id+'-=-=-=-=-'+owa);
                orgid = owa.id;
            }
        }
        List<OrgWideEmailAddress> lstEmailAddress = [SELECT Id,DisplayName,Address FROM OrgWideEmailAddress WHERE Id =:orgid];
        // String plainText = htmlBody.stripHtmlTags();
        String NameCredsDevName = '';
        if (!lstEmailAddress.isEmpty()) {
            String displayName = lstEmailAddress[0].DisplayName;

            // Remove "Admissions " if it exists
            displayName = displayName.replace('Admissions ', '');

            // Now take the first 4 characters
            String NameCredsInsitals = displayName.substring(0, 4);
            
            System.debug('-=-=-NameCreds-=-=-='+NameCredsInsitals);
            for(NamedCredential namedCreds : [SELECT Id, DeveloperName, MasterLabel FROM NamedCredential]) {
                if( namedCreds.MasterLabel.contains(NameCredsInsitals)){
                    System.debug('-=-=-=-=+++-=--=-=-='+namedCreds.MasterLabel);
                    NameCredsDevName = namedCreds.DeveloperName;
                }
            }
        } else {
            System.debug('Error in @future method' + ' No Org Wide Email Address found for '+Ssortcode+' Please contact your System Administrator.');
            // throw new AuraHandledException('No Org Wide Email Address found for '+Ssortcode+' Please contact your System Administrator.');
        }
        String[] Emails = new list<string>();
        
        List <School_List__mdt> CalendarEmailMdt =[select id,Calendar_Email__c,State__c,label,MasterLabel from School_List__mdt where label=:Ssortcode];
        //Try {
            Emails.add(e[0].Enquiry_Email__c);
        if(!Test.isRunningTest()){Emails.add(CalendarEmailMdt[0].Calendar_Email__c);}
            
            system.debug('emails :: '+Emails);
       // }
        //Catch (System.exception ex){
            //System.debug('#### Exception Executed : '+ex.getMessage() + '  '+ex.getStackTraceString() + ' '+ex.getLineNumber());
            
        //}
		        
        String strStartDateTime = e[0].StartDateTime.format('yyyy-MM-dd\'T\'HH:mm:ss+05:30');
        String strEndDateTime = e[0].EndDateTime.format('yyyy-MM-dd\'T\'HH:mm:ss+05:30');
        String requestBody ='';
        system.debug('ooooEnquirY.School_Tour_Scheduled__c::'    + ooooEnquirY.School_Tour_Scheduled__c);
        system.debug('ooooEnquirY.School_Tour_Re_Scheduled__c::'    + ooooEnquirY.School_Tour_Re_Scheduled__c);
        system.debug('ooooAdmission_Form.Non_Stellar_Interaction_Scheduled__c::'    + ooooAdmission_Form.Non_Stellar_Interaction_Scheduled__c);
        system.debug('ooooAdmission_Form.Non_Stellar_Interaction_Reschedule__c::'    + ooooAdmission_Form.Non_Stellar_Interaction_Reschedule__c);
       // if(!test.isRunningTest()){
            //String requestBody = '{"end": {"dateTime": "'+strEndDateTime+'"},"start": { "dateTime": "'+strStartDateTime+'" }, "attendees": [ {"email":"'+ e[0].Contact__r.Email +' ","displayName": "'+lstEmailAddress[0].DisplayName+'"}'+ ',{"email":"'+CalendarEmailMdt[0].Calendar_Email__c+'","displayName": "'+lstEmailAddress[0].DisplayName+'"}],' + '"summary": "'+e[0].Subject +' '+e[0].Contact__r.Name+'","description":"'+htmlBody+'"}';
            
            // REMOVED conferenceData section and ADDED location field with billing address

        System.debug('===== DEBUG START: Google Calendar Request Build =====');

        System.debug('ooooEnquirY = ' + ooooEnquirY);
        System.debug('ooooAdmission_Form = ' + ooooAdmission_Form);
        System.debug('locationAddress = ' + locationAddress);
        System.debug('strStartDateTime = ' + strStartDateTime);
        System.debug('strEndDateTime = ' + strEndDateTime);

        System.debug('e size = ' + (e == null ? null : e.size()));
        System.debug('lstEmailAddress size = ' + (lstEmailAddress == null ? null : lstEmailAddress.size()));
        System.debug('CalendarEmailMdt size = ' + (CalendarEmailMdt == null ? null : CalendarEmailMdt.size()));

        if(e == null || e.isEmpty()){
            System.debug('ERROR: e list is NULL/EMPTY');
            return null;
        }
        if(lstEmailAddress == null || lstEmailAddress.isEmpty()){
            System.debug('ERROR: lstEmailAddress list is NULL/EMPTY');
            return null;
        }
        if(CalendarEmailMdt == null || CalendarEmailMdt.isEmpty()){
            System.debug('ERROR: CalendarEmailMdt list is NULL/EMPTY');
            return null;
        }

        System.debug('e[0] = ' + e[0]);
        System.debug('lstEmailAddress[0] = ' + lstEmailAddress[0]);
        System.debug('CalendarEmailMdt[0] = ' + CalendarEmailMdt[0]);

        System.debug('ooooEnquirY.Email__c = ' + (ooooEnquirY == null ? null : ooooEnquirY.Email__c));
        System.debug('ooooAdmission_Form.Email_Address__c = ' + (ooooAdmission_Form == null ? null : ooooAdmission_Form.Email_Address__c));

        System.debug('ooooEnquirY.School_Tour_Scheduled__c = ' + (ooooEnquirY == null ? null : ooooEnquirY.School_Tour_Scheduled__c));
        System.debug('ooooEnquirY.School_Tour_Re_Scheduled__c = ' + (ooooEnquirY == null ? null : ooooEnquirY.School_Tour_Re_Scheduled__c));

        System.debug('ooooAdmission_Form.Non_Stellar_Interaction_Scheduled__c = ' + (ooooAdmission_Form == null ? null : ooooAdmission_Form.Non_Stellar_Interaction_Scheduled__c));
        System.debug('ooooAdmission_Form.Non_Stellar_Interaction_Reschedule__c = ' + (ooooAdmission_Form == null ? null : ooooAdmission_Form.Non_Stellar_Interaction_Reschedule__c));

        System.debug('===== DEBUG END =====');

        String attendeeEmail;
        String attendeeName = lstEmailAddress[0].DisplayName;
        String calendarEmail = CalendarEmailMdt[0].Calendar_Email__c;

        Boolean isSchoolTourScheduled = (ooooEnquirY != null && ooooEnquirY.School_Tour_Scheduled__c == true);
        Boolean isSchoolTourRescheduled = (ooooEnquirY != null && ooooEnquirY.School_Tour_Re_Scheduled__c == true);

        Boolean isNonStellarScheduled = (ooooAdmission_Form != null && ooooAdmission_Form.Non_Stellar_Interaction_Scheduled__c == true);
        Boolean isNonStellarReschedule = (ooooAdmission_Form != null && ooooAdmission_Form.Non_Stellar_Interaction_Reschedule__c == true);

        System.debug('Flags => isSchoolTourScheduled=' + isSchoolTourScheduled +
                    ', isSchoolTourRescheduled=' + isSchoolTourRescheduled +
                    ', isNonStellarScheduled=' + isNonStellarScheduled +
                    ', isNonStellarReschedule=' + isNonStellarReschedule);

        if(isSchoolTourScheduled && !isNonStellarScheduled){
            System.debug('Branch 1 executed');
            attendeeEmail = ooooEnquirY.Email__c;

        }else if(isSchoolTourRescheduled && !isNonStellarScheduled){
            System.debug('Branch 2 executed');
            attendeeEmail = ooooEnquirY.Email__c;

        }else if(isNonStellarScheduled && !isSchoolTourRescheduled){
            System.debug('Branch 3 executed');
            attendeeEmail = ooooAdmission_Form.Email_Address__c;

        }else if(isNonStellarReschedule && !isSchoolTourRescheduled){
            System.debug('Branch 4 executed');
            attendeeEmail = ooooAdmission_Form.Email_Address__c;

        }else{
            System.debug('Branch 5 executed');
            attendeeEmail = e[0].Enquiry_Email__c;
        }

        System.debug('Final attendeeEmail chosen = ' + attendeeEmail);

        if(String.isBlank(attendeeEmail)){
            System.debug('âŒ ERROR: attendeeEmail is NULL/BLANK - cannot create requestBody');
            return null;
        }

        requestBody =
            '{"end":{"dateTime":"' + strEndDateTime +
            '"},"start":{"dateTime":"' + strStartDateTime +
            '"},"attendees":[{"email":"' + attendeeEmail +
            '","displayName":"' + attendeeName +
            '"},{"email":"' + calendarEmail +
            '"}],"summary":"' + e[0].Subject +
            '","description":"","location":"' + locationAddress +
            '"}';

        System.debug('Final requestBody = ' + requestBody);

            
            // requestBody = '{"end": {"dateTime": "'+strEndDateTime+'"},"start": { "dateTime": "'+strStartDateTime+'" }, "attendees": [ {"email":"' +e[0].Contact__r.Email+'","displayName": "'+lstEmailAddress[0].DisplayName+'"}'+',{"email":"'+CalendarEmailMdt[0].Calendar_Email__c+'"}],'+'"conferenceData": {   "conferenceSolution": {   "key": {  "type": "hangoutsMeet" },  "name": "Google Meet Link" }, "createRequest": {   "conferenceSolutionKey": {     "type": "hangoutsMeet"   },   "requestId": "ACB" " }},'  +'"summary": "'+e[0].Subject +' '+e[0].Contact__r.Name+'","description":"'+htmlBody+'"}';
            System.debug('#### requestBody '+requestBody);
       // }
        Http http = new Http();
        HttpRequest httpReq = new HttpRequest();
        HttpResponse HttpRes = new HttpResponse();
        System.debug('NameCredsDevName ==>'+NameCredsDevName);
        // REMOVED conferenceDataVersion parameter from endpoint
        httpReq.setEndpoint('callout:'+NameCredsDevName+'/calendars/'+lstEmailAddress[0].Address+'/events?sendNotifications=true&sendUpdates=all');
        System.debug('endpoint ==>'+'callout:'+NameCredsDevName+'/calendars/'+lstEmailAddress[0].Address+'/events?sendNotifications=true&sendUpdates=all');
        System.debug('request endpoint ==>' + httpReq.getEndpoint());
        httpReq.setMethod('POST');
        httpReq.setBody(requestBody);
        httpReq.setHeader('Content-Type', 'application/json');
        //httpReq.setHeader('Authorization','Bearer '+accessToken);
        httpReq.setHeader('Accept',' application/json');
        string LinkUrl;
        //try{
            HttpRes = http.send(httpReq);
            statusCode = HttpRes.getStatusCode();

            System.debug('statusCode ==>'+ statusCode);

            if(HttpRes.getStatusCode() == 200){
                System.debug('Calendar Created Successfully @@@@@@@@@@@@'+   HttpRes.getBody());
            }else{
                System.debug('HttpRes.getBody()==>' + HttpRes.getBody() + ' - ' + HttpRes.getStatus());
                System.debug('Unexpected Error while communicating with Google Calendar API. '
                             +' Body ' +HttpRes.getBody() +'@Status '+HttpRes.getStatus()+' and Status Code '+HttpRes.getStatuscode());
            }
        //}catch(System.Exception es){
          //////  System.debug('#### Exception Executed : '+es.getMessage() + '  '+es.getStackTraceString() + ' '+es.getLineNumber());
        /////////////////////////}
        List<Event> eLinkUrl = new list <event>();
        system.debug('LocationAddress   --- ' +  locationAddress);
        if(!e.isEmpty()){
            for(Event oEvent : e){
                Event osEvent = new Event();
                osEvent.id = oEvent.id;
                osEvent.Location = locationAddress; // Set to billing address instead of meet link
                osEvent.Meeting_Rescheduling_Link__c = ''; // Set to empty
                eLinkUrl.add(osEvent);
            }
            system.debug('eLinkUrl   --- ' +  eLinkUrl);
            if(!eLinkUrl.isEmpty()){
                update eLinkUrl;
            }
            
            // REMOVED Meeting_Link__c updates for Enquiry__c and Admission_Form__c
            // The records themselves are not updated with meeting links anymore
        }
        
        system.debug('eLinkUrl   --- ' +  eLinkUrl);
        return HttpRes;
    }
    public static void fakeMethod() {
        Integer j = 0;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
        j++;
    }
}
/*
* Class that is used to Create event in Google Calender for Meet Online Button
* @author  Hitesh Shantaram Nimje
* @created 16/09/2020
*/