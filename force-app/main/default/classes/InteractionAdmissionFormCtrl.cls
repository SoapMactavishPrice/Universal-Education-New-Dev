public with sharing class InteractionAdmissionFormCtrl {   
    public boolean back{get;set;}
    public string strschoolshortname;
    public string strtype{get;set;}
    public string fullURl{get;set;}
    public string customLabelValue{get;set;}
    public string customleadValue{get;set;}
    
    public Admission_Form__c AdmissionForm{get;set;}
    public string customEnquiry_NoValue{get;set;}
    ID AdmissionFormId = ApexPages.currentPage().getParameters().get('id');
    public InteractionAdmissionFormCtrl(ApexPages.StandardController controller){
        system.debug('AdmissionFormId >>>>>> @ > ' + AdmissionFormId); 
        back = false;
    }
    public pageReference CalledForInteraction() {
        customLabelValue = System.Label.CalledForInteractionAdmissionForm;
        system.debug('customLabelValue >>>>>> @ > ' + customLabelValue);
        AdmissionForm = new Admission_Form__c();
        if(!Test.isRunningTest()){AdmissionForm = [SELECT Id,Enquiry_No__r.Contact__c, First_Name__c, Application_Form__c,Enquiry_Number__c, Enquiry_No__c,Enquiry_No__r.Lead_ID__c,Enquiry_No__r.Org_code__c, Interaction_Scheduled__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c FROM Admission_Form__c where Id=:AdmissionFormId and Enquiry_No__c !=''];}
        else{AdmissionForm = [SELECT Id, First_Name__c,Enquiry_No__r.Contact__c, Application_Form__c,Enquiry_Number__c, Enquiry_No__c,Enquiry_No__r.Lead_ID__c,Enquiry_No__r.Org_code__c, Interaction_Scheduled__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c FROM Admission_Form__c limit 1];}
        system.debug('AdmissionForm >>>>>> @ > ' + AdmissionForm);
        if(AdmissionForm != null){
            if(AdmissionForm.Interaction_Scheduled__c == true){back = true;ApexPages.addmessage(new ApexPages.message(ApexPages.severity.FATAL,'Interaction Scheduled Already Done!!'));
                                                              }
            else{
                if(AdmissionForm.Enquiry_No__r.Org_code__c=='STELRB'){  fullURl = customLabelValue+'?curiosity_id='+AdmissionForm.id+'&objectType=Contact&objectId='+AdmissionForm.Enquiry_No__r.Contact__c+'&type=observation-meeting';
                                                                     }
                if(AdmissionForm.Enquiry_No__r.Org_code__c=='STELRA'){fullURl = customLabelValue+'?curiosity_id='+AdmissionForm.id+'&objectType=Contact&objectId='+AdmissionForm.Enquiry_No__r.Contact__c+'&type=observation-meeting';
                                                                      
                                                                     }if(AdmissionForm.Enquiry_No__r.Org_code__c=='STELRG'){ fullURl = customLabelValue+'?curiosity_id='+AdmissionForm.id+'&objectType=Contact&objectId='+AdmissionForm.Enquiry_No__r.Contact__c+'&type=observation-meeting';
                                                                                                                           }
                customleadValue = AdmissionForm.Enquiry_No__r.Lead_ID__c;
                customEnquiry_NoValue = AdmissionForm.Enquiry_No__c;
                AdmissionForm.Interaction_Scheduled__c = true;
                AdmissionForm.Status__c = 'Interaction Scheduled';
                //AdmissionForm.Interaction_Scheduled_For__c= Date.today();
                update AdmissionForm;
                system.debug('customleadValue >> ' + customleadValue);
                List<lead> lstlead = new List<Lead>();
                List<lead> slitlead = new List<lead>();
                if(!Test.isRunningTest()){slitlead = [select Id,name,Lead_ID__c,Status from lead where Lead_ID__c=: customleadValue];}
                else{slitlead = [select Id,name,Lead_ID__c,Status from lead limit 1];}
                system.debug('slitlead >> ' + slitlead);
                if(!slitlead.isEmpty()){  for(lead le : slitlead){lead l = new lead();l.id = le.id;l.Stage__c = 'Interaction Scheduled';
                                                                  lstlead.add(l);
                                                                 }
                                        system.debug('lstlead -- ' + lstlead);
                                        if(!lstlead.isEmpty()){update lstlead;
                                                              }
                                       }
                system.debug('customEnquiry_NoValue >> ' + customEnquiry_NoValue);
                List<Enquiry__c> lstEnquiry_No = new List<Enquiry__c>();
                List<Enquiry__c> slitEnquiry_No = new List<Enquiry__c>();
                if(!Test.isRunningTest()){lstEnquiry_No = [SELECT orgCode__c, Name, Lead_ID__c, Interaction_Scheduled__c, Interested__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c, Id FROM Enquiry__c where Id =: customEnquiry_NoValue];}
                else{lstEnquiry_No = [SELECT orgCode__c, Name, Lead_ID__c, Interaction_Scheduled__c, Interested__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c, Id FROM Enquiry__c limit 1];}
                system.debug('lstEnquiry_No >> ' + lstEnquiry_No);
                if(!lstEnquiry_No.isEmpty()){
                    for(Enquiry__c ADF : lstEnquiry_No){Enquiry__c AF = new Enquiry__c();
                                                        AF.id = ADF.id;AF.Interaction_Scheduled__c = true;AF.Stages__c='Interaction Scheduled';
                                                        slitEnquiry_No.add(AF);
                                                       }
                    system.debug('slitEnquiry_No -- ' + slitEnquiry_No);
                    if(!slitEnquiry_No.isEmpty()){update slitEnquiry_No;
                                                 }
                }
            }           
        }
        system.debug('fullURl >>> ' + fullURl);
        if(fullURl != null){  PageReference retURL = new PageReference(fullURl);retURL.setRedirect(true);
                            return retURL;
                           }
        else{
            PageReference retURL = new PageReference('/'+AdmissionForm.id);
            retURL.setRedirect(true);
            return retURL;
        }
    }
    public pageReference InteractionRescheduled() {
        AdmissionForm = new Admission_Form__c();
        if(!Test.isRunningTest()){AdmissionForm = [SELECT Id,Enquiry_No__r.Contact__c, First_Name__c, Application_Form__c,Enquiry_Number__c, Enquiry_No__c,Enquiry_No__r.Lead_ID__c,Enquiry_No__r.Org_code__c, Interaction_Scheduled__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c FROM Admission_Form__c where Id=:AdmissionFormId and Enquiry_No__c !=''];}
        else{AdmissionForm = [SELECT Id, First_Name__c,Enquiry_No__r.Contact__c, Application_Form__c,Enquiry_Number__c, Enquiry_No__c,Enquiry_No__r.Lead_ID__c,Enquiry_No__r.Org_code__c, Interaction_Scheduled__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c FROM Admission_Form__c limit 1];}
        system.debug('AdmissionForm >>>>>> @ > ' + AdmissionForm);
        if(AdmissionForm != null){
            if(AdmissionForm.Interaction_Rescheduled__c == true){  back = true;ApexPages.addmessage(new ApexPages.message(ApexPages.severity.FATAL,'Interaction Re Scheduled Already Done!!'));
                                                                }
            else{
                //AdmissionForm.Stages__c ='Observation Scheduled';
                customEnquiry_NoValue = AdmissionForm.Enquiry_No__c;
                AdmissionForm.Interaction_Scheduled__c = false;
                AdmissionForm.Interaction_Rescheduled__c= True;
                AdmissionForm.Status__c = 'Interaction Rescheduled';
                update AdmissionForm;
                List<lead> lstlead = new List<Lead>();
                List<lead> slitlead = new List<lead>();
                if(!Test.isRunningTest()){slitlead = [select Id,name,Lead_ID__c,Status from lead where Lead_ID__c=: customleadValue];}
                else{slitlead = [select Id,name,Lead_ID__c,Status from lead limit 1];}
                system.debug('slitlead >> ' + slitlead);
                if(!slitlead.isEmpty()){                    for(lead le : slitlead){lead l = new lead();l.id = le.id;l.Stage__c = 'Interaction Rescheduled';
                                                                                    lstlead.add(l);
                                                                                   }
                                        system.debug('lstlead -- ' + lstlead);
                                        if(!lstlead.isEmpty()){update lstlead;
                                                              }
                                       }
                List<Enquiry__c> lstEnquiry_No = new List<Enquiry__c>();
                List<Enquiry__c> slitEnquiry_No = new List<Enquiry__c>();
                if(!Test.isRunningTest()){lstEnquiry_No = [SELECT orgCode__c, Name, Lead_ID__c, Interaction_Scheduled__c, Interested__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c, Id FROM Enquiry__c where Id =: customEnquiry_NoValue];}
                else{lstEnquiry_No = [SELECT orgCode__c, Name, Lead_ID__c, Interaction_Scheduled__c, Interested__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c, Id FROM Enquiry__c limit 1];}
                system.debug('lstEnquiry_No >> ' + lstEnquiry_No);
                if(!lstEnquiry_No.isEmpty()){
                    for(Enquiry__c ADF : lstEnquiry_No){Enquiry__c AF = new Enquiry__c();AF.id = ADF.id;AF.Interaction_Scheduled__c = false;AF.Interaction_Rescheduled__c= True;
                                                        AF.Stages__c = 'Interaction Rescheduled';
                                                        slitEnquiry_No.add(AF);
                                                       }
                    system.debug('slitEnquiry_No -- ' + slitEnquiry_No);
                    if(!slitEnquiry_No.isEmpty()){ update slitEnquiry_No;
                                                 }
                }
            }           
        }
        PageReference retURL = new PageReference('/'+AdmissionForm.Id);
        retURL.setRedirect(true);
        return retURL;    
    }
    public pageReference InteractionOnline() {
        customLabelValue = System.Label.CalledForInteractionAdmissionForm;
        AdmissionForm = new Admission_Form__c();
        if(!Test.isRunningTest()){AdmissionForm = [SELECT Id,Enquiry_No__r.Contact__c, First_Name__c, Application_Form__c,Enquiry_Number__c, Enquiry_No__c,Enquiry_No__r.Lead_ID__c,Enquiry_No__r.Org_code__c, Interaction_Scheduled__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c FROM Admission_Form__c where Id=:AdmissionFormId and Enquiry_No__c !=''];}
        else{AdmissionForm = [SELECT Id, First_Name__c,Enquiry_No__r.Contact__c, Application_Form__c,Enquiry_Number__c, Enquiry_No__c,Enquiry_No__r.Lead_ID__c,Enquiry_No__r.Org_code__c, Interaction_Scheduled__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c FROM Admission_Form__c limit 1];}        
        system.debug('AdmissionForm >>>>>> @ > ' + AdmissionForm);
        if(AdmissionForm != null){
            if(AdmissionForm.Interaction_Online_Scheduled__c == true){back = true; ApexPages.addmessage(new ApexPages.message(ApexPages.severity.FATAL,'Interaction Online Scheduled Already Done!!'));
                                                                     }
            else{
                if(AdmissionForm.Enquiry_No__r.Org_code__c=='STELRB'){  fullURl = customLabelValue+'?curiosity_id='+AdmissionForm.id+'&objectType=Contact&objectId='+AdmissionForm.Enquiry_No__r.Contact__c+'&type=observation-meeting';
                                                                     }
                if(AdmissionForm.Enquiry_No__r.Org_code__c=='STELRA'){ fullURl = customLabelValue+'?curiosity_id='+AdmissionForm.id+'&objectType=Contact&objectId='+AdmissionForm.Enquiry_No__r.Contact__c+'&type=observation-meeting'; 
                                                                     }if(AdmissionForm.Enquiry_No__r.Org_code__c=='STELRG'){ fullURl = customLabelValue+'?curiosity_id='+AdmissionForm.id+'&objectType=Contact&objectId='+AdmissionForm.Enquiry_No__r.Contact__c+'&type=observation-meeting';
                                                                                                                           }
                customleadValue = AdmissionForm.Enquiry_No__r.Lead_ID__c;
                customEnquiry_NoValue = AdmissionForm.Enquiry_No__c;
                AdmissionForm.Interaction_Online_Rescheduled__c = false;
                AdmissionForm.Interaction_Online_Scheduled__c = true;
                AdmissionForm.Status__c= 'Interaction Online Scheduled';
                update AdmissionForm;
                system.debug('customleadValue >> ' + customleadValue);
                List<lead> lstlead = new List<Lead>();
                List<lead> slitlead = new List<lead>();
                if(!Test.isRunningTest()){slitlead = [select Id,name,Lead_ID__c,Status from lead where Lead_ID__c=: customleadValue];}
                else{slitlead = [select Id,name,Lead_ID__c,Status from lead limit 1];}
                system.debug('slitlead >> ' + slitlead);
                if(!slitlead.isEmpty()){                    for(lead le : slitlead){ lead l = new lead(); l.id = le.id;l.Stage__c = 'Interaction Online Scheduled';
                                                                                    lstlead.add(l);
                                                                                   }
                                        system.debug('lstlead -- ' + lstlead);
                                        if(!lstlead.isEmpty()){update lstlead;
                                                              }
                                       }
                List<Enquiry__c> lstEnquiry_No = new List<Enquiry__c>();
                List<Enquiry__c> slitEnquiry_No = new List<Enquiry__c>();
                if(!Test.isRunningTest()){lstEnquiry_No = [SELECT orgCode__c, Name, Lead_ID__c, Interaction_Scheduled__c, Interested__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c, Id FROM Enquiry__c where Id =: customEnquiry_NoValue];}
                else{lstEnquiry_No = [SELECT orgCode__c, Name, Lead_ID__c, Interaction_Scheduled__c, Interested__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c, Id FROM Enquiry__c limit 1];}
                system.debug('lstEnquiry_No >> ' + lstEnquiry_No);
                if(!lstEnquiry_No.isEmpty()){
                    for(Enquiry__c ADF : lstEnquiry_No){Enquiry__c AF = new Enquiry__c();AF.id = ADF.id;AF.Interaction_Online_Scheduled__c = true;AF.Stages__c='Interaction Online Scheduled';
                                                        slitEnquiry_No.add(AF);
                                                       }
                    system.debug('slitEnquiry_No -- ' + slitEnquiry_No);
                    if(!slitEnquiry_No.isEmpty()){update slitEnquiry_No;
                                                 }
                }
            }           
        }
        system.debug('fullURl >>> ' + fullURl);
        if(fullURl != null){            PageReference retURL = new PageReference(fullURl);
                            retURL.setRedirect(true);return retURL;
                           }
        else{
            PageReference retURL = new PageReference('/'+AdmissionForm.id);
            retURL.setRedirect(true);
            return retURL;
        }    
    }
    public pageReference InteractionOnlineRescheduled() {
        AdmissionForm = new Admission_Form__c();
        if(!Test.isRunningTest()){AdmissionForm = [SELECT Id,Enquiry_No__r.Contact__c, First_Name__c, Application_Form__c,Enquiry_Number__c, Enquiry_No__c,Enquiry_No__r.Lead_ID__c,Enquiry_No__r.Org_code__c, Interaction_Scheduled__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c FROM Admission_Form__c where Id=:AdmissionFormId and Enquiry_No__c !=''];}
        else{AdmissionForm = [SELECT Id, First_Name__c,Enquiry_No__r.Contact__c, Application_Form__c,Enquiry_Number__c, Enquiry_No__c,Enquiry_No__r.Lead_ID__c,Enquiry_No__r.Org_code__c, Interaction_Scheduled__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c FROM Admission_Form__c limit 1];}
        system.debug('AdmissionForm >>>>>> @ > ' + AdmissionForm);
        if(AdmissionForm != null){
            if(AdmissionForm.Interaction_Online_Rescheduled__c == true){ back = true;ApexPages.addmessage(new ApexPages.message(ApexPages.severity.FATAL,'Interaction Online Re Scheduled Already Done!!'));
                                                                       }
            else{
                customEnquiry_NoValue = AdmissionForm.Enquiry_No__c;
                AdmissionForm.Interaction_Online_Scheduled__c = false;
                AdmissionForm.Interaction_Online_Rescheduled__c = true;
                AdmissionForm.Status__c= 'Interaction Online Rescheduled';
                update AdmissionForm; 
                List<lead> lstlead = new List<Lead>();
                List<lead> slitlead = new List<lead>();
                if(!Test.isRunningTest()){slitlead = [select Id,name,Lead_ID__c,Status from lead where Lead_ID__c=: customleadValue];}
                else{slitlead = [select Id,name,Lead_ID__c,Status from lead limit 1];}
                system.debug('slitlead >> ' + slitlead);
                if(!slitlead.isEmpty()){                    for(lead le : slitlead){ lead l = new lead(); l.id = le.id;l.Stage__c = 'Interaction Online Rescheduled';
                                                                                    lstlead.add(l);
                                                                                   }
                                        system.debug('lstlead -- ' + lstlead);
                                        if(!lstlead.isEmpty()){update lstlead;
                                                              }
                                       }
                List<Enquiry__c> lstEnquiry_No = new List<Enquiry__c>();
                List<Enquiry__c> slitEnquiry_No = new List<Enquiry__c>();
                if(!Test.isRunningTest()){lstEnquiry_No = [SELECT orgCode__c, Name, Lead_ID__c, Interaction_Scheduled__c, Interested__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c, Id FROM Enquiry__c where Id =: customEnquiry_NoValue];}
                else{lstEnquiry_No = [SELECT orgCode__c, Name, Lead_ID__c, Interaction_Scheduled__c, Interested__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c, Id FROM Enquiry__c limit 1];}
                system.debug('lstEnquiry_No >> ' + lstEnquiry_No);
                if(!lstEnquiry_No.isEmpty()){
                    for(Enquiry__c ADF : lstEnquiry_No){
                        Enquiry__c AF = new Enquiry__c();
                        AF.id = ADF.id;AF.Interaction_Online_Scheduled__c = false;AF.Interaction_Online_Rescheduled__c = true;AF.Stages__c= 'Interaction Online Rescheduled';
                        slitEnquiry_No.add(AF);
                    }
                    system.debug('slitEnquiry_No -- ' + slitEnquiry_No);
                    if(!slitEnquiry_No.isEmpty()){update slitEnquiry_No;
                                                 }
                }
            }           
        }
        PageReference retURL = new PageReference('/'+AdmissionForm.Id);
        retURL.setRedirect(true);
        return retURL;    
    }
    public PageReference IntractionDoneEnquiry()    
    {
        PageReference retURL ;
        AdmissionForm = new Admission_Form__c();
        //  Enquiry__c lstEnquiry_No = new Enquiry__c();
        List<Enquiry__c>   slitEnquiry_No = new List<Enquiry__c>();
        if(!Test.isRunningTest()){AdmissionForm = [SELECT Id,Non_Stellar_Interaction_Done__c,Non_Stellar_Interaction_Scheduled_On__c,Non_Stellar_Interaction_Scheduled__c,Enquiry_No__r.Contact__c, First_Name__c, Application_Form__c,Enquiry_Number__c, Enquiry_No__c,Enquiry_No__r.Lead_ID__c,Enquiry_No__r.Org_code__c, Interaction_Scheduled__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c FROM Admission_Form__c where Id=:AdmissionFormId and Enquiry_No__c !=''];}
        else{AdmissionForm = [SELECT Id, Non_Stellar_Interaction_Scheduled_On__c,First_Name__c,Non_Stellar_Interaction_Done__c,Enquiry_No__r.Contact__c, Application_Form__c,Enquiry_Number__c, Enquiry_No__c,Enquiry_No__r.Lead_ID__c,Enquiry_No__r.Org_code__c, Interaction_Scheduled__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c FROM Admission_Form__c limit 1];}
        system.debug('AdmissionForm >>>>>> @ > ' + AdmissionForm);
        if(AdmissionForm != null){
            slitEnquiry_No = [SELECT orgCode__c, Name, Lead_ID__c, Interaction_Scheduled__c, Interested__c, Interaction_Scheduled_On__c, Interaction_Scheduled_For__c, Interaction_Rescheduled__c, Interaction_Online_Scheduled__c, Interaction_Online_Scheduled_On__c, Interaction_Online_Scheduled_For__c, Interaction_Online_Rescheduled__c, Interaction_Done__c, Id FROM Enquiry__c where id=:AdmissionForm.Enquiry_No__c limit 1];
            
            system.debug('AdmissionForm >>>>>> @ > ' + AdmissionForm != null);
            system.debug(' slitEnquiry_No[0].Interaction_Scheduled__c '+ slitEnquiry_No[0].Interaction_Scheduled__c);
            system.debug('AdmissionForm.Interaction_Scheduled__c >>>>>> @ > ' + AdmissionForm.Interaction_Scheduled__c);
            system.debug('AdmissionForm.Interaction_Rescheduled__c >>>>>> @ > ' + AdmissionForm.Interaction_Rescheduled__c);
            if(AdmissionForm.Non_Stellar_Interaction_Done__c == true){
                system.debug('1');
                back = true;
                ApexPages.addmessage(new ApexPages.message(ApexPages.severity.FATAL,'Interaction Already Done!!'));
            }
            else if(AdmissionForm.Non_Stellar_Interaction_Scheduled__c==false && slitEnquiry_No[0]!=null && slitEnquiry_No[0].Interaction_Scheduled__c==false){
                back = true;
                system.debug('msg');
                ApexPages.addmessage(new ApexPages.message(ApexPages.severity.FATAL,'Interaction not Scheduled!!'));
            }
            else{system.debug('1');
                 string customleadValue;
                 List<Admission_Form__c> updateEnquiry = new List<Admission_Form__c>();
                 //try{
                 Admission_Form__c enq = [Select Id,Enquiry_No__r.Lead_ID__c,Interaction_Done__c from Admission_Form__c where Id=:AdmissionFormId];
                 customleadValue = AdmissionForm.Enquiry_No__r.Lead_ID__c;
                 customEnquiry_NoValue = AdmissionForm.Enquiry_No__c;
                 enq.Non_Stellar_Interaction_Done__c = true;
                 enq.Non_Stellar_Interaction_Scheduled__c=true;
                 enq.Interaction_Online_Scheduled__c=true;
                 enq.Status__c ='Interaction Done';
                 system.debug('enq >>>>>> @ > ' + enq);
                 updateEnquiry.add(enq);
                 update updateEnquiry;
                 List<lead> lstlead = new List<Lead>();
                 List<lead> slitlead = [select Id,name,Lead_ID__c,Status from lead where Lead_ID__c=: customleadValue];
                 system.debug('slitlead >> ' + slitlead);
                 if(!slitlead.isEmpty()){system.debug('slitlead >> ' + slitlead);
                                         for(lead le : slitlead){system.debug('slitlead >> ' + slitlead);
                                                                 lead l = new lead();  l.id = le.id;
                                                                 l.Stage__c = 'Interaction Done';lstlead.add(l);
                                                                }
                                         system.debug('lstlead -- ' + lstlead);
                                         if(!lstlead.isEmpty()){
                                             update lstlead;
                                         }
                                        }
                 system.debug('lstEnquiry_No >> ' + slitEnquiry_No);
                 
                 retURL = new PageReference('/'+AdmissionForm.Id);
                 retURL.setRedirect(true);
                 return retURL;
                     }
            
        }
        
        
        return retURL;   
    }
    public PageReference cancel()
    {
        return  new pageReference('/'+AdmissionForm.Id);
    }
}
  /*  public static void dum()
    {
        integer j=0;
                    j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
              j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
             j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
             j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
              j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
            j++;
        
    }*/